{{define "list_pokemons"}}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Pok√©mons</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: linear-gradient(135deg, #667eea, #764ba2); font-family: Arial, sans-serif; color: #fff; }
        nav { background: rgba(0,0,0,0.3); padding: 15px; }
        nav a { color: white; text-decoration: none; margin: 0 15px; padding: 8px 15px; border-radius: 5px; }
        nav a:hover { background: rgba(255,255,255,0.2); }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; font-size: 2.5em; margin: 20px 0; color: white; }
        .search-box { background: rgba(0,0,0,0.2); padding: 30px; border-radius: 15px; margin: 20px 0; }
        .search-box input { width: 70%; padding: 12px 20px; border: none; border-radius: 25px; font-size: 16px; }
        .search-box button { padding: 12px 30px; background: #ff6b6b; color: white; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; margin-left: 10px; }
        .pokemon-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .pokemon-card { background: linear-gradient(135deg, #a8edea, #fed6e3); border-radius: 20px; padding: 25px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); position: relative; }
        .pokemon-card:hover { transform: translateY(-10px); }
        .pokemon-card img { width: 150px; height: 150px; }
        .pokemon-card h3 { color: #2d3436; font-weight: 900; font-size: 20px; margin: 15px 0; }
        .pokemon-card a { color: #2d3436; text-decoration: none; }
        .pokemon-card p { color: #2d3436; font-weight: 600; margin: 5px 0; }
        .type-badge { padding: 8px 16px; border-radius: 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; font-size: 14px; font-weight: 700; display: inline-block; margin: 3px; }
        .favorite-btn { position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 24px; cursor: pointer; color: #ccc; }
        .favorite-btn:hover { color: #ff6b6b; }
        .favorite-btn.active { color: #ff0000; }
        .pagination { text-align: center; margin: 30px 0; }
        .pagination a, .pagination span { padding: 8px 12px; border: 2px solid rgba(255,255,255,0.5); border-radius: 10px; text-decoration: none; color: white; background: rgba(0,0,0,0.2); margin: 0 5px; }
        .pagination .current { background: white; color: #667eea; }
        .info { text-align: center; margin: 20px 0; color: white; }
    </style>
</head>

<body>
    <nav>
        <a href="/pokemons">Accueil</a>
        <a href="/search">Recherche</a>
        <a href="/categories">Cat√©gories</a>
        <a href="/favorites">Favoris</a>
    </nav>

    <div style="max-width: 1400px; margin: 0 auto; padding: 20px;">
        <h1 style="text-align: center; font-size: 2.5em; margin-bottom: 30px; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Pok√©dex</h1>

        <!-- Barre de recherche principale -->
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <form method="GET" action="/pokemons" style="max-width: 800px; margin: 0 auto;">
                <div style="display: flex; gap: 10px; align-items: center; background: white; border-radius: 50px; padding: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <input type="text" name="search" placeholder="üîç Rechercher un Pok√©mon par nom..." value="{{.SearchQuery}}" 
                           style="flex: 1; border: 2px solid rgba(102, 126, 234, 0.2); padding: 12px 20px; font-size: 16px; border-radius: 50px; outline: none; background: rgba(255, 255, 255, 0.9); color: #2d3436;">
                    <input type="hidden" name="type" value="{{.FilterType}}">
                    <button type="submit" style="padding: 12px 30px; background: #ff6b6b; color: white; border: none; border-radius: 50px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s;">
                        Rechercher
                    </button>
                </div>
                <p style="text-align: center; color: white; margin-top: 15px; font-size: 14px;">
                    D√©couvrez et explorez tous vos Pok√©mons pr√©f√©r√©s
                </p>
            </form>
        </div>

        <div class="controls">
            <form method="GET" action="/pokemons">
                <select name="type" onchange="this.form.submit()">
                    <option value="">Tous les types</option>
                    <option value="Plante" {{if eq .FilterType "Plante"}}selected{{end}}>Plante</option>
                    <option value="Feu" {{if eq .FilterType "Feu"}}selected{{end}}>Feu</option>
                    <option value="Eau" {{if eq .FilterType "Eau"}}selected{{end}}>Eau</option>
                    <option value="√âlectrik" {{if eq .FilterType "√âlectrik"}}selected{{end}}>√âlectrik</option>
                    <option value="Vol" {{if eq .FilterType "Vol"}}selected{{end}}>Vol</option>
                    <option value="Poison" {{if eq .FilterType "Poison"}}selected{{end}}>Poison</option>
                    <option value="Normal" {{if eq .FilterType "Normal"}}selected{{end}}>Normal</option>
                    <option value="Combat" {{if eq .FilterType "Combat"}}selected{{end}}>Combat</option>
                    <option value="Psy" {{if eq .FilterType "Psy"}}selected{{end}}>Psy</option>
                    <option value="Roche" {{if eq .FilterType "Roche"}}selected{{end}}>Roche</option>
                    <option value="Sol" {{if eq .FilterType "Sol"}}selected{{end}}>Sol</option>
                    <option value="Insecte" {{if eq .FilterType "Insecte"}}selected{{end}}>Insecte</option>
                    <option value="Glace" {{if eq .FilterType "Glace"}}selected{{end}}>Glace</option>
                    <option value="Dragon" {{if eq .FilterType "Dragon"}}selected{{end}}>Dragon</option>
                    <option value="Spectre" {{if eq .FilterType "Spectre"}}selected{{end}}>Spectre</option>
                    <option value="T√©n√®bres" {{if eq .FilterType "T√©n√®bres"}}selected{{end}}>T√©n√®bres</option>
                    <option value="Acier" {{if eq .FilterType "Acier"}}selected{{end}}>Acier</option>
                    <option value="F√©e" {{if eq .FilterType "F√©e"}}selected{{end}}>F√©e</option>
                </select>
                <input type="hidden" name="search" value="{{.SearchQuery}}">
                <input type="hidden" name="min_weight" value="{{.MinWeight}}">
                <input type="hidden" name="max_weight" value="{{.MaxWeight}}">
                <input type="hidden" name="min_exp" value="{{.MinExp}}">
                <input type="hidden" name="max_exp" value="{{.MaxExp}}">
            </form>

            {{if or .SearchQuery .FilterType .MinWeight .MaxWeight .MinExp .MaxExp}}
            <a href="/pokemons" style="padding: 8px 16px; background: #6c757d; color: white; text-decoration: none; border-radius: 4px;">R√©initialiser</a>
            {{end}}
        </div>

        <!-- Filtres avanc√©s -->
        <div style="max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <h3 style="margin-top: 0; color: #333;">üîç Filtres avanc√©s</h3>
            <form method="GET" action="/pokemons">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #555;">‚öñÔ∏è Poids minimum (kg):</label>
                        <input type="number" name="min_weight" value="{{.MinWeight}}" placeholder="Ex: 5" step="0.1" 
                               style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #555;">‚öñÔ∏è Poids maximum (kg):</label>
                        <input type="number" name="max_weight" value="{{.MaxWeight}}" placeholder="Ex: 100" step="0.1"
                               style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #555;">‚≠ê Exp√©rience minimum:</label>
                        <input type="number" name="min_exp" value="{{.MinExp}}" placeholder="Ex: 50"
                               style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #555;">‚≠ê Exp√©rience maximum:</label>
                        <input type="number" name="max_exp" value="{{.MaxExp}}" placeholder="Ex: 300"
                               style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
                    </div>
                </div>
                <input type="hidden" name="search" value="{{.SearchQuery}}">
                <input type="hidden" name="type" value="{{.FilterType}}">
                <button type="submit" style="width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 16px;">
                    Appliquer les filtres
                </button>
            </form>
        </div>

        <div class="info">
            {{if .TotalCount}}
            <p>{{.TotalCount}} Pok√©mon(s) trouv√©(s) - Page {{.Page}} sur {{.TotalPages}}</p>
            {{else}}
            <p>Aucun Pok√©mon trouv√©</p>
            {{end}}
        </div>

        <div class="pokemon-grid">
            {{range .Pokemons}}
            <div class="pokemon-card">
                {{if contains $.Favorites .Id}}
                <form class="favorite-form" method="POST" action="/favorites/remove">
                    <input type="hidden" name="pokemon_id" value="{{.Id}}">
                    <button type="submit" class="favorite-btn active" title="Retirer des favoris">‚ô•</button>
                </form>
                {{else}}
                <form class="favorite-form" method="POST" action="/favorites/add">
                    <input type="hidden" name="pokemon_id" value="{{.Id}}">
                    <button type="submit" class="favorite-btn" title="Ajouter aux favoris">‚ô°</button>
                </form>
                {{end}}
                <a href="/pokemons/{{.Id}}">
                    <img src="{{.Image}}" alt="{{.Name}}">
                    <h3>#{{.Id}} {{.Name}}</h3>
                    <div>
                        {{range .Types}}
                        <span class="type-badge">{{.Name}}</span>
                        {{end}}
                    </div>
                    <p>‚öñÔ∏è Poids: {{.Weight}}</p>
                    <p>‚≠ê Exp√©rience: {{.BaseExperience}}</p>
                </a>
            </div>
            {{end}}
        </div>

        {{if .Pokemons}}
        <div class="pagination">
            {{if .HasPrevious}}
            <a href="/pokemons?page={{.Page | add -1}}{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .FilterType}}&type={{.FilterType}}{{end}}{{if .MinWeight}}&min_weight={{.MinWeight}}{{end}}{{if .MaxWeight}}&max_weight={{.MaxWeight}}{{end}}{{if .MinExp}}&min_exp={{.MinExp}}{{end}}{{if .MaxExp}}&max_exp={{.MaxExp}}{{end}}">‚Üê Pr√©c√©dent</a>
            {{end}}

            <span class="current">Page {{.Page}} / {{.TotalPages}}</span>

            {{if .HasNext}}
            <a href="/pokemons?page={{.Page | add 1}}{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .FilterType}}&type={{.FilterType}}{{end}}{{if .MinWeight}}&min_weight={{.MinWeight}}{{end}}{{if .MaxWeight}}&max_weight={{.MaxWeight}}{{end}}{{if .MinExp}}&min_exp={{.MinExp}}{{end}}{{if .MaxExp}}&max_exp={{.MaxExp}}{{end}}">Suivant ‚Üí</a>
            {{end}}
        </div>
        {{end}}
    </div>
</body>

</html>
{{end}}